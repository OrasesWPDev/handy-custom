# CLAUDE.md

Essential development guidance for Claude Code when working with this WordPress plugin.

## Development Notes

- **Filter System**: New `[filter-products]` and `[filter-recipes]` shortcodes use unified `Handy_Custom_Filters_Renderer` class
- **Asset Loading**: Filter CSS/JS only enqueue when filter shortcodes detected on page
- **Template Structure**: Filter HTML removed from content templates, now in `templates/shortcodes/filters/archive.php`
- **Single Product URLs**: `post_type_link` filter generates `/products/{category}/{product-slug}/` permalinks automatically when products are saved with assigned top-level categories
- **URL Structure**: Dual system - incoming URLs handled by rewrite rules in `handle_product_urls()`, outgoing URLs generated by `custom_product_permalink()` filter
- **Category Logic**: Primary top-level category (parent=0) used for URL generation; falls back to first assigned category if no top-level found
- **Version Updates**: Always update ALL version references: `handy-custom.php` header, `HANDY_CUSTOM_VERSION` constant, AND `Handy_Custom::VERSION` constant to match GitHub release tag
- **Debug Flag**: Filter JS respects `HANDY_CUSTOM_DEBUG` constant for console logging
- **Auto-Updater**: Plugin uses YahnisElsts Plugin Update Checker v5.6 library for reliable GitHub-based updates
  - Industry-standard library that doesn't interfere with WordPress core update processes
  - Direct GitHub integration without requiring additional servers or infrastructure
  - Implemented in `Handy_Custom_Simple_Updater` class, initialized only in admin context
  - Shows update notifications in WordPress admin when GitHub releases are newer than current version
  - Check period set to 1 minute (`setCheckPeriod(1/60)`) for fast update detection
  - Plugin version must always match GitHub release tag version exactly