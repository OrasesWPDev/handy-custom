# CLAUDE.md

Essential development guidance for Claude Code when working with this WordPress plugin.

## Development Notes

- **Filter System**: New `[filter-products]` and `[filter-recipes]` shortcodes use unified `Handy_Custom_Filters_Renderer` class
- **Asset Loading**: Filter CSS/JS only enqueue when filter shortcodes detected on page
- **Template Structure**: Filter HTML removed from content templates, now in `templates/shortcodes/filters/archive.php`
- **Single Product URLs**: `post_type_link` filter generates `/products/{category}/{product-slug}/` permalinks automatically when products are saved with assigned top-level categories
- **URL Structure**: Dual system - incoming URLs handled by rewrite rules in `handle_product_urls()`, outgoing URLs generated by `custom_product_permalink()` filter
- **Category Logic**: Primary top-level category (parent=0) used for URL generation; falls back to first assigned category if no top-level found
- **Version Updates**: Always update both `handy-custom.php` header AND `Handy_Custom::VERSION` constant
- **Debug Flag**: Filter JS respects `HANDY_CUSTOM_DEBUG` constant for console logging
- **Auto-Updater**: Plugin includes GitHub-based auto-updater in `Handy_Custom_Plugin_Updater` class, initialized only in admin context
  - Hooks into WordPress update system via `pre_set_site_transient_update_plugins` and `plugins_api` filters
  - Shows update notifications in WordPress admin when GitHub releases are newer than current version